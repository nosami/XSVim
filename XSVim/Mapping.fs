namespace XSVim

[<AutoOpen>]
module mapping =
    let colemakToQwerty = function
        | "f" -> "e"
        | "p" -> "r"
        | "g" -> "t"
        | "j" -> "y"
        | "l" -> "u"
        | "u" -> "i"
        | "y" -> "o"
        | ";" -> "p"
        | "r" -> "s"
        | "s" -> "d"
        | "t" -> "f"
        | "d" -> "g"
        | "n" -> "j"
        | "e" -> "k"
        | "i" -> "l"
        | "o" -> ";"
        | "k" -> "n"
        | "F" -> "E"
        | "P" -> "R"
        | "G" -> "T"
        | "J" -> "Y"
        | "L" -> "U"
        | "U" -> "I"
        | "Y" -> "O"
        | ":" -> "P"
        | "R" -> "S"
        | "S" -> "D"
        | "T" -> "F"
        | "D" -> "G"
        | "N" -> "J"
        | "E" -> "K"
        | "I" -> "L"
        | "O" -> ":"
        | "K" -> "N"
        | c -> c

    let dvorakToQwerty = function
        | "[" -> "-"
        | "]" -> "="
        | "'" -> "q"
        | "," -> "w"
        | "." -> "e"
        | "p" -> "r"
        | "y" -> "t"
        | "f" -> "y"
        | "g" -> "u"
        | "c" -> "i"
        | "r" -> "o"
        | "l" -> "p"
        | "/" -> "["
        | "=" -> "]"
        | "o" -> "s"
        | "e" -> "d"
        | "u" -> "f"
        | "i" -> "g"
        | "d" -> "h"
        | "h" -> "j"
        | "t" -> "k"
        | "n" -> "l"
        | "s" -> ";"
        | "-" -> "'"
        | ";" -> "z"
        | "q" -> "x"
        | "j" -> "c"
        | "k" -> "v"
        | "x" -> "b"
        | "b" -> "n"
        | "w" -> ","
        | "v" -> "."
        | "z" -> "/"
        | "{" -> "_"
        | "}" -> "+"
        | "\"" -> "Q"
        | "<" -> "W"
        | ">" -> "E"
        | "P" -> "R"
        | "Y" -> "T"
        | "F" -> "Y"
        | "G" -> "U"
        | "C" -> "I"
        | "R" -> "O"
        | "L" -> "P"
        | "?" -> "{"
        | "+" -> "}"
        | "O" -> "S"
        | "E" -> "D"
        | "U" -> "F"
        | "I" -> "G"
        | "D" -> "H"
        | "H" -> "J"
        | "T" -> "K"
        | "N" -> "L"
        | "S" -> ":"
        | "_" -> "\""
        | ":" -> "Z"
        | "Q" -> "X"
        | "J" -> "C"
        | "K" -> "V"
        | "X" -> "B"
        | "B" -> "N"
        | "M" -> "M"
        | "W" -> "<"
        | "V" -> ">"
        | "Z" -> "?"
        | c -> c

    let remap layout key =
        match layout with
        | Colemak -> colemakToQwerty key
        | Dvorak -> dvorakToQwerty key
        | _ -> key
